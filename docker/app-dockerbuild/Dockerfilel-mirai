FROM debian:latest
RUN apt-get update
RUN apt-get install -y python3
RUN apt-get install -y python3-pip
RUN apt-get install -y wget

#Mirai dependencies
RUN apt-get install -y gcc golang electric-fence sudo
RUN apt-get install -y mysql-server mysql-client
RUN git clone git clone https://github.com/jgamblin/Mirai-Source-Code
RUN mkdir /etc/xcompile
RUN cd /etc/xcompile
 
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-armv4l.tar.bz2
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-armv5l.tar.bz2
RUN wget http://distro.ibiblio.org/slitaz/sources/packages/c/cross-compiler-armv6l.tar.bz2
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-i586.tar.bz2
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-i686.tar.bz2
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-m68k.tar.bz2
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-mips.tar.bz2
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-mipsel.tar.bz2
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-powerpc.tar.bz2
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-sh4.tar.bz2
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-sparc.tar.bz2
RUN wget https://www.uclibc.org/downloads/binaries/0.9.30.1/cross-compiler-x86_64.tar.bz2
 
RUN tar -jxf cross-compiler-armv4l.tar.bz2
RUN tar -jxf cross-compiler-armv5l.tar.bz2
RUN tar -jxf cross-compiler-armv6l.tar.bz2
RUN tar -jxf cross-compiler-i586.tar.bz2
RUN tar -jxf cross-compiler-i686.tar.bz2
RUN tar -jxf cross-compiler-m68k.tar.bz2
RUN tar -jxf cross-compiler-mips.tar.bz2
RUN tar -jxf cross-compiler-mipsel.tar.bz2
RUN tar -jxf cross-compiler-powerpc.tar.bz2
RUN tar -jxf cross-compiler-sh4.tar.bz2
RUN tar -jxf cross-compiler-sparc.tar.bz2
RUN tar -jxf cross-compiler-x86_64.tar.bz2
 
RUN rm *.tar.bz2
RUN mv cross-compiler-armv4l armv4l
RUN mv cross-compiler-armv5l armv5l
RUN mv cross-compiler-armv6l armv6l
RUN mv cross-compiler-i586 i586
RUN mv cross-compiler-i686 i686
RUN mv cross-compiler-m68k m68k
RUN mv cross-compiler-mips mips
RUN mv cross-compiler-mipsel mipsel
RUN mv cross-compiler-powerpc powerpc
RUN mv cross-compiler-sh4 sh4
RUN mv cross-compiler-sparc sparc
RUN mv cross-compiler-x86_64 x86_64

RUN export PATH=$PATH:/etc/xcompile/armv4l/bin
RUN export PATH=$PATH:/etc/xcompile/armv6l/bin
RUN export PATH=$PATH:/etc/xcompile/i586/bin
RUN export PATH=$PATH:/etc/xcompile/m68k/bin
RUN export PATH=$PATH:/etc/xcompile/mips/bin
RUN export PATH=$PATH:/etc/xcompile/mipsel/bin
RUN export PATH=$PATH:/etc/xcompile/powerpc/bin
RUN export PATH=$PATH:/etc/xcompile/powerpc-440fp/bin
RUN export PATH=$PATH:/etc/xcompile/sh4/bin
RUN export PATH=$PATH:/etc/xcompile/sparc/bin
RUN export PATH=$PATH:/etc/xcompile/armv6l/bin
RUN export PATH=$PATH:/usr/local/go/bin
RUN export GOPATH=$HOME/Documents/go
RUN go get github.com/go-sql-driver/mysql
RUN go get github.com/mattn/go-shellwords 

RUN pip3 install RPi.GPIO
ADD application/IR-sensor.py /home/
CMD ["python3", "/home/IR-sensor.py"]
